<!--
CpGenius Application Architecture Overview
Generated: August 26, 2025
-->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 900" style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);">
  <defs>
    <!-- Gradients -->
    <linearGradient id="primaryGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#06b6d4"/>
      <stop offset="100%" style="stop-color:#3b82f6"/>
    </linearGradient>
    <linearGradient id="secondaryGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="celeryGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="dataGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>

    <!-- Filters -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="700" y="40" text-anchor="middle" fill="url(#primaryGrad)" font-family="Arial, sans-serif" font-size="28" font-weight="bold">
    CpGenius - DNA Methylation Analysis Platform
  </text>
  <text x="700" y="65" text-anchor="middle" fill="#94a3b8" font-family="Arial, sans-serif" font-size="14">
    FastAPI + Celery + Docker + Redis Architecture
  </text>

  <!-- User Interface Layer -->
  <g>
    <!-- Browser/Frontend -->
    <rect x="50" y="100" width="200" height="120" rx="12" fill="url(#primaryGrad)" opacity="0.8" filter="url(#glow)"/>
    <text x="150" y="125" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Frontend Interface</text>
    <text x="150" y="145" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="12">HTML Templates</text>
    <text x="150" y="160" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="12">• bval.html</text>
    <text x="150" y="175" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="12">• index.html</text>
    <text x="150" y="190" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="12">JavaScript (bval.js)</text>
    <text x="150" y="205" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="12">Tailwind CSS</text>
  </g>

  <!-- FastAPI Application Layer -->
  <g>
    <!-- Main FastAPI App -->
    <rect x="350" y="100" width="300" height="220" rx="12" fill="url(#secondaryGrad)" opacity="0.8" filter="url(#glow)"/>
    <text x="500" y="125" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="18" font-weight="bold">FastAPI Application</text>
    <text x="500" y="145" text-anchor="middle" fill="#dcfce7" font-family="Arial, sans-serif" font-size="12">Port: 8001</text>

    <!-- Router boxes -->
    <rect x="370" y="160" width="120" height="35" rx="6" fill="rgba(255,255,255,0.2)" stroke="#dcfce7" stroke-width="1"/>
    <text x="430" y="180" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">HTML Router</text>

    <rect x="510" y="160" width="120" height="35" rx="6" fill="rgba(255,255,255,0.2)" stroke="#dcfce7" stroke-width="1"/>
    <text x="570" y="180" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">File Upload Router</text>

    <rect x="370" y="205" width="120" height="35" rx="6" fill="rgba(255,255,255,0.2)" stroke="#dcfce7" stroke-width="1"/>
    <text x="430" y="225" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Prognosis Router</text>

    <rect x="510" y="205" width="120" height="35" rx="6" fill="rgba(255,255,255,0.2)" stroke="#dcfce7" stroke-width="1"/>
    <text x="570" y="225" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Util Router</text>

    <!-- API Endpoints -->
    <text x="380" y="260" fill="#dcfce7" font-family="Arial, sans-serif" font-size="10">• /bval (IDAT upload)</text>
    <text x="380" y="275" fill="#dcfce7" font-family="Arial, sans-serif" font-size="10">• /files/upload</text>
    <text x="380" y="290" fill="#dcfce7" font-family="Arial, sans-serif" font-size="10">• /prognosis/images/{hash}</text>
    <text x="510" y="260" fill="#dcfce7" font-family="Arial, sans-serif" font-size="10">• /prognosis/download-all/{hash}</text>
    <text x="510" y="275" fill="#dcfce7" font-family="Arial, sans-serif" font-size="10">• /files/status/{task_id}</text>
    <text x="510" y="290" fill="#dcfce7" font-family="Arial, sans-serif" font-size="10">• /files/list</text>
  </g>

  <!-- Celery Task Processing -->
  <g>
    <!-- Celery Worker -->
    <rect x="750" y="100" width="250" height="180" rx="12" fill="url(#celeryGrad)" opacity="0.8" filter="url(#glow)"/>
    <text x="875" y="125" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="18" font-weight="bold">Celery Worker</text>
    <text x="875" y="145" text-anchor="middle" fill="#fef3c7" font-family="Arial, sans-serif" font-size="12">Async Task Processing</text>

    <!-- Task modules -->
    <rect x="770" y="160" width="90" height="30" rx="6" fill="rgba(255,255,255,0.2)" stroke="#fef3c7" stroke-width="1"/>
    <text x="815" y="178" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">file_tasks.py</text>

    <rect x="880" y="160" width="100" height="30" rx="6" fill="rgba(255,255,255,0.2)" stroke="#fef3c7" stroke-width="1"/>
    <text x="930" y="178" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">prognosis_tasks.py</text>

    <text x="780" y="210" fill="#fef3c7" font-family="Arial, sans-serif" font-size="10">• IDAT file processing</text>
    <text x="780" y="225" fill="#fef3c7" font-family="Arial, sans-serif" font-size="10">• CSV analysis</text>
    <text x="780" y="240" fill="#fef3c7" font-family="Arial, sans-serif" font-size="10">• Feature selection algorithms</text>
    <text x="780" y="255" fill="#fef3c7" font-family="Arial, sans-serif" font-size="10">• PNG visualization generation</text>
  </g>

  <!-- Redis Message Broker -->
  <g>
    <rect x="1100" y="100" width="150" height="100" rx="12" fill="#dc2626" opacity="0.8" filter="url(#glow)"/>
    <text x="1175" y="125" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Redis</text>
    <text x="1175" y="145" text-anchor="middle" fill="#fecaca" font-family="Arial, sans-serif" font-size="12">Message Broker</text>
    <text x="1175" y="160" text-anchor="middle" fill="#fecaca" font-family="Arial, sans-serif" font-size="10">Port: 6379</text>
    <text x="1175" y="175" text-anchor="middle" fill="#fecaca" font-family="Arial, sans-serif" font-size="10">Task Queue</text>
    <text x="1175" y="190" text-anchor="middle" fill="#fecaca" font-family="Arial, sans-serif" font-size="10">Results Backend</text>
  </g>

  <!-- Machine Learning Algorithms -->
  <g>
    <rect x="350" y="380" width="600" height="180" rx="12" fill="url(#dataGrad)" opacity="0.8" filter="url(#glow)"/>
    <text x="650" y="405" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="18" font-weight="bold">ML Algorithms & Analysis</text>
    <text x="650" y="425" text-anchor="middle" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="12">Feature Selection & Classification Algorithms</text>

    <!-- Algorithm boxes -->
    <rect x="370" y="440" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="420" y="455" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">ANOVA F-Test</text>

    <rect x="480" y="440" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="530" y="455" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">Random Forest</text>

    <rect x="590" y="440" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="640" y="455" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">LASSO Regression</text>

    <rect x="700" y="440" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="750" y="455" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">RFE SVM</text>

    <rect x="810" y="440" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="860" y="455" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">SHAP XGBoost</text>

    <rect x="370" y="475" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="420" y="490" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">Ridge L2</text>

    <rect x="480" y="475" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="530" y="490" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">Garsen-Olden MLP</text>

    <rect x="590" y="475" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="640" y="490" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">Post Borda</text>

    <rect x="700" y="475" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="750" y="490" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">CpG Gene Mapping</text>

    <rect x="810" y="475" width="100" height="25" rx="4" fill="rgba(255,255,255,0.2)" stroke="#e9d5ff" stroke-width="1"/>
    <text x="860" y="490" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">Dummy Classifier</text>

    <!-- Features -->
    <text x="380" y="520" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="10">• Feature selection and ranking</text>
    <text x="380" y="535" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="10">• Cross-validation</text>
    <text x="380" y="550" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="10">• Performance metrics calculation</text>

    <text x="650" y="520" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="10">• Ensemble methods</text>
    <text x="650" y="535" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="10">• Statistical analysis</text>
    <text x="650" y="550" fill="#e9d5ff" font-family="Arial, sans-serif" font-size="10">• Visualization generation</text>
  </g>

  <!-- Docker Container -->
  <g>
    <rect x="1050" y="350" width="200" height="120" rx="12" fill="#0ea5e9" opacity="0.8" filter="url(#glow)"/>
    <text x="1150" y="375" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Docker</text>
    <text x="1150" y="395" text-anchor="middle" fill="#bae6fd" font-family="Arial, sans-serif" font-size="12">R-MinFi Container</text>
    <text x="1150" y="415" text-anchor="middle" fill="#bae6fd" font-family="Arial, sans-serif" font-size="10">IDAT Processing</text>
    <text x="1150" y="430" fill="#bae6fd" font-family="Arial, sans-serif" font-size="10">• Methylation analysis</text>
    <text x="1150" y="445" fill="#bae6fd" font-family="Arial, sans-serif" font-size="10">• Beta value calculation</text>
    <text x="1150" y="460" fill="#bae6fd" font-family="Arial, sans-serif" font-size="10">• Quality control</text>
  </g>

  <!-- Data Storage -->
  <g>
    <!-- File System -->
    <rect x="50" y="650" width="200" height="120" rx="12" fill="#475569" opacity="0.8" filter="url(#glow)"/>
    <text x="150" y="675" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">File Storage</text>
    <text x="150" y="695" text-anchor="middle" fill="#cbd5e1" font-family="Arial, sans-serif" font-size="12">uploads/ directory</text>
    <text x="150" y="715" text-anchor="middle" fill="#cbd5e1" font-family="Arial, sans-serif" font-size="10">• IDAT files</text>
    <text x="150" y="730" text-anchor="middle" fill="#cbd5e1" font-family="Arial, sans-serif" font-size="10">• CSV files</text>
    <text x="150" y="745" text-anchor="middle" fill="#cbd5e1" font-family="Arial, sans-serif" font-size="10">• Generated PNGs</text>
    <text x="150" y="760" text-anchor="middle" fill="#cbd5e1" font-family="Arial, sans-serif" font-size="10">• Analysis results</text>
  </g>

  <!-- Output Files -->
  <g>
    <rect x="350" y="650" width="300" height="120" rx="12" fill="#7c3aed" opacity="0.8" filter="url(#glow)"/>
    <text x="500" y="675" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Generated Outputs</text>
    <text x="500" y="695" text-anchor="middle" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="12">Analysis Results</text>

    <text x="370" y="715" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• Feature selection results</text>
    <text x="370" y="730" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• array_type.csv</text>
    <text x="370" y="745" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• bval_data.csv</text>
    <text x="370" y="760" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• Visualization PNGs</text>

    <text x="520" y="715" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• Performance metrics</text>
    <text x="520" y="730" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• Model comparisons</text>
    <text x="520" y="745" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• Feature rankings</text>
    <text x="520" y="760" fill="#ddd6fe" font-family="Arial, sans-serif" font-size="10">• ZIP downloads</text>
  </g>

  <!-- Package Management -->
  <g>
    <rect x="750" y="650" width="150" height="80" rx="12" fill="#059669" opacity="0.8" filter="url(#glow)"/>
    <text x="825" y="675" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="14" font-weight="bold">uv</text>
    <text x="825" y="695" text-anchor="middle" fill="#d1fae5" font-family="Arial, sans-serif" font-size="12">Package Manager</text>
    <text x="825" y="710" text-anchor="middle" fill="#d1fae5" font-family="Arial, sans-serif" font-size="10">Python dependencies</text>
    <text x="825" y="725" text-anchor="middle" fill="#d1fae5" font-family="Arial, sans-serif" font-size="10">pyproject.toml</text>
  </g>

  <!-- Development Tools -->
  <g>
    <rect x="950" y="650" width="150" height="80" rx="12" fill="#be123c" opacity="0.8" filter="url(#glow)"/>
    <text x="1025" y="675" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="14" font-weight="bold">NPM</text>
    <text x="1025" y="695" text-anchor="middle" fill="#fecdd3" font-family="Arial, sans-serif" font-size="12">Frontend Tools</text>
    <text x="1025" y="710" text-anchor="middle" fill="#fecdd3" font-family="Arial, sans-serif" font-size="10">Tailwind CSS</text>
    <text x="1025" y="725" text-anchor="middle" fill="#fecdd3" font-family="Arial, sans-serif" font-size="10">Build tools</text>
  </g>

  <!-- Arrows and Flow -->
  <!-- Frontend to FastAPI -->
  <line x1="250" y1="160" x2="350" y2="160" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="300" y="155" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10">HTTP Requests</text>

  <!-- FastAPI to Celery -->
  <line x1="650" y1="200" x2="750" y2="200" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="700" y="195" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10">Task Queue</text>

  <!-- Celery to Redis -->
  <line x1="1000" y1="150" x2="1100" y2="150" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="1050" y="145" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10">Messages</text>

  <!-- Celery to Algorithms -->
  <line x1="875" y1="280" x2="875" y2="380" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="890" y="330" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10">Process</text>

  <!-- Celery to Docker -->
  <line x1="950" y1="280" x2="1100" y2="350" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="1025" y="315" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10">R Processing</text>

  <!-- FastAPI to Storage -->
  <line x1="350" y1="300" x2="250" y2="650" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="290" y="475" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10" transform="rotate(-60 290 475)">File I/O</text>

  <!-- Algorithms to Output -->
  <line x1="650" y1="560" x2="500" y2="650" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="575" y="605" text-anchor="middle" fill="#64748b" font-family="Arial, sans-serif" font-size="10">Results</text>

  <!-- Legend -->
  <g>
    <rect x="50" y="800" width="1200" height="60" rx="8" fill="rgba(15, 23, 42, 0.8)" stroke="#475569" stroke-width="1"/>
    <text x="70" y="820" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Data Flow:</text>
    <text x="70" y="835" fill="#94a3b8" font-family="Arial, sans-serif" font-size="11">1. User uploads IDAT/CSV files via web interface</text>
    <text x="70" y="850" fill="#94a3b8" font-family="Arial, sans-serif" font-size="11">2. FastAPI receives files, computes SHA-1, and queues Celery tasks</text>

    <text x="650" y="835" fill="#94a3b8" font-family="Arial, sans-serif" font-size="11">3. Celery processes files using ML algorithms and Docker R container</text>
    <text x="650" y="850" fill="#94a3b8" font-family="Arial, sans-serif" font-size="11">4. Results stored as PNG visualizations and CSV data for download</text>
  </g>
</svg>